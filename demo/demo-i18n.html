<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-i18n="meta.title">Excel Wizard</title>

    <!-- i18n System -->
    <script src="i18n/translations.js"></script>
    <script src="i18n/i18n.js"></script>

    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        max-width: 800px;
        margin: 0 auto;
      }
      .language-switcher {
        margin-bottom: 20px;
      }
      .lang-btn {
        padding: 8px 16px;
        margin: 0 5px;
        border: 1px solid #ccc;
        background: #f5f5f5;
        cursor: pointer;
      }
      .lang-btn.active {
        background: #007bff;
        color: white;
      }
      .demo-section {
        margin: 20px 0;
        padding: 15px;
        border: 1px solid #eee;
        border-radius: 5px;
      }
      h1,
      h2 {
        color: #333;
      }
      .stats {
        display: flex;
        gap: 20px;
        margin: 10px 0;
      }
      .stat-item {
        padding: 10px;
        background: #f9f9f9;
        border-radius: 3px;
      }
    </style>
  </head>
  <body>
    <div class="language-switcher">
      <button
        class="lang-btn active"
        data-lang="ko"
        onclick="switchLanguage('ko')"
      >
        한국어
      </button>
      <button class="lang-btn" data-lang="en" onclick="switchLanguage('en')">
        English
      </button>
    </div>

    <h1 data-i18n="header.title">🧙‍♂️ Excel Wizard</h1>
    <p data-i18n="header.subtitle">엑셀 작업을 쉽고 빠르게</p>

    <div class="demo-section">
      <h2 data-i18n="dataMerge.title">데이터 병합</h2>
      <p data-i18n="dataMerge.diagramDescription">
        동일한 구조의 여러 엑셀 파일을 하나의 시트로 합칩니다
      </p>

      <div class="stats">
        <div class="stat-item">
          <span data-i18n="dataMerge.stats.totalFiles">총 파일 수:</span>
          <strong>3</strong>
        </div>
        <div class="stat-item">
          <span data-i18n="dataMerge.stats.totalSheets">총 시트 수:</span>
          <strong>5</strong>
        </div>
        <div class="stat-item">
          <span data-i18n="dataMerge.stats.totalRows">총 데이터 행:</span>
          <strong>1,240</strong>
        </div>
      </div>

      <button data-i18n="dataMerge.buttons.clear">초기화</button>
      <button data-i18n="dataMerge.buttons.merge">시트 합치기</button>
      <button data-i18n="dataMerge.buttons.download">
        💾 통합 파일 다운로드
      </button>
    </div>

    <div class="demo-section">
      <h2 data-i18n="sheetCreator.title">시트 생성기</h2>
      <p data-i18n="sheetCreator.diagramDescription">
        입력한 텍스트를 각각의 이름으로 하는 시트들을 생성합니다
      </p>

      <input
        type="text"
        data-i18n-placeholder="sheetCreator.placeholder"
        style="width: 100%; padding: 8px; margin: 10px 0"
      />

      <button data-i18n="sheetCreator.buttons.create">시트 생성</button>
      <button data-i18n="sheetCreator.buttons.download">
        💾 엑셀 파일 다운로드
      </button>
    </div>

    <div class="demo-section">
      <h2>i18n 시스템 정보</h2>
      <p><strong>현재 언어:</strong> <span id="currentLang"></span></p>
      <p><strong>지원 언어:</strong> <span id="supportedLangs"></span></p>
      <p><strong>번역 테스트:</strong> <span id="translationTest"></span></p>

      <script>
        function updateI18nInfo() {
          if (window.i18n) {
            document.getElementById("currentLang").textContent =
              window.i18n.getCurrentLanguage();
            document.getElementById("supportedLangs").textContent = window.i18n
              .getSupportedLanguages()
              .join(", ");
            document.getElementById("translationTest").textContent =
              window.t("common.processing");
          }
        }

        // 언어 변경 이벤트 리스너
        document.addEventListener("languageChanged", updateI18nInfo);
        document.addEventListener("DOMContentLoaded", updateI18nInfo);
      </script>
    </div>

    <footer style="margin-top: 40px; text-align: center; color: #666">
      <p data-i18n="footer.copyright">
        &copy; 2024 Excel Wizard. All rights reserved.
      </p>
    </footer>

    <script>
      function switchLanguage(lang) {
        if (window.i18n) {
          window.i18n.setLanguage(lang);
        }
      }
    </script>
  </body>
</html>
