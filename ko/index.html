<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Excel Wizard - 엑셀 마법사 | 온라인 엑셀 병합 도구</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="무료 온라인 엑셀 파일 병합, 시트 생성, 데이터 정리 도구. 여러 엑셀 파일을 하나로 합치고, 새로운 시트를 생성하고, 데이터를 표 형태로 정리하세요." />
    <meta name="keywords" content="엑셀 병합, 엑셀 도구, 온라인 엑셀, 파일 합치기, 시트 생성, 데이터 정리, Excel merge, Excel tool" />
    <meta name="robots" content="index, follow" />
    <meta name="author" content="Excel Wizard" />
    <link rel="canonical" href="https://yoursite.com/ko/" />
    
    <!-- Language and Internationalization -->
    <link rel="alternate" hreflang="ko" href="https://yoursite.com/ko/" />
    <link rel="alternate" hreflang="en" href="https://yoursite.com/en/" />
    <link rel="alternate" hreflang="x-default" href="https://yoursite.com/" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://yoursite.com/ko/" />
    <meta property="og:title" content="Excel Wizard - 엑셀 마법사" />
    <meta property="og:description" content="무료 온라인 엑셀 파일 병합, 시트 생성, 데이터 정리 도구" />
    <meta property="og:image" content="https://yoursite.com/shared/images/og-image-ko.png" />
    <meta property="og:site_name" content="Excel Wizard" />
    <meta property="og:locale" content="ko_KR" />
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://yoursite.com/ko/" />
    <meta property="twitter:title" content="Excel Wizard - 엑셀 마법사" />
    <meta property="twitter:description" content="무료 온라인 엑셀 파일 병합, 시트 생성, 데이터 정리 도구" />
    <meta property="twitter:image" content="https://yoursite.com/shared/images/twitter-image-ko.png" />
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../shared/favicon.ico" />
    <link rel="apple-touch-icon" href="../shared/apple-touch-icon.png" />
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Excel Wizard",
      "description": "무료 온라인 엑셀 파일 병합, 시트 생성, 데이터 정리 도구",
      "url": "https://yoursite.com/ko/",
      "applicationCategory": "BusinessApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "KRW"
      },
      "inLanguage": "ko-KR"
    }
    </script>
    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="css/merge-tool.css" />
    <link rel="stylesheet" href="css/sheet-creator.css" />
    <link rel="stylesheet" href="css/table-organizer.css" />
    <link rel="stylesheet" href="css/sheet-selector.css" />
    <link rel="stylesheet" href="css/diagram.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  </head>
  <body>
    <div class="app-container">
      <!-- 헤더 -->
      <header class="app-header">
        <div class="header-content">
          <div class="header-main">
            <h1 class="app-title">🧙‍♂️ Excel Wizard</h1>
            <p class="app-subtitle">엑셀 작업을 쉽고 빠르게</p>
          </div>
          <div class="language-switcher">
            <button class="lang-btn active" data-lang="ko">한국어</button>
            <button class="lang-btn" data-lang="en" onclick="switchLanguage('en')">English</button>
          </div>
        </div>
      </header>

      <!-- 네비게이션 -->
      <nav class="tool-navigation">
        <button class="nav-btn active" data-tool="merge">
          <span class="nav-icon">🔀</span>
          <span class="nav-text">데이터 병합</span>
        </button>
        <button class="nav-btn" data-tool="split">
          <span class="nav-icon">📝</span>
          <span class="nav-text">시트 생성</span>
        </button>
        <button class="nav-btn" data-tool="convert">
          <span class="nav-icon">📋</span>
          <span class="nav-text">표 정리</span>
        </button>
        <button class="nav-btn" data-tool="analyze">
          <span class="nav-icon">🔗</span>
          <span class="nav-text">시트 선택</span>
        </button>
      </nav>

      <!-- 메인 콘텐츠 영역 -->
      <main class="main-content">
        <!-- 데이터 병합 도구 -->
        <div id="merge-tool" class="tool-container active">
          <h2 class="tool-title">데이터 병합</h2>

          <!-- 도식 설명 -->
          <div class="tool-diagram">
            <div class="diagram-title">💡 데이터 병합이란?</div>
            <div class="diagram-content">
              <div class="diagram-step">
                <div class="file-example">
                  <div class="file-icon">📄</div>
                  <div class="file-name">파일1.xlsx</div>
                  <div class="file-table">
                    <table>
                      <tr>
                        <th>이름</th>
                        <th>나이</th>
                      </tr>
                      <tr>
                        <td>홍길동</td>
                        <td>25</td>
                      </tr>
                      <tr>
                        <td>이영희</td>
                        <td>28</td>
                      </tr>
                    </table>
                  </div>
                </div>
                <div class="plus-icon">+</div>
                <div class="file-example">
                  <div class="file-icon">📄</div>
                  <div class="file-name">파일2.xlsx</div>
                  <div class="file-table">
                    <table>
                      <tr>
                        <th>이름</th>
                        <th>나이</th>
                      </tr>
                      <tr>
                        <td>김철수</td>
                        <td>30</td>
                      </tr>
                      <tr>
                        <td>박영수</td>
                        <td>22</td>
                      </tr>
                    </table>
                  </div>
                </div>
                <div class="arrow-icon">→</div>
                <div class="file-example result">
                  <div class="file-icon">📄</div>
                  <div class="file-name">통합파일.xlsx</div>
                  <div class="file-table">
                    <table>
                      <tr>
                        <th>이름</th>
                        <th>나이</th>
                      </tr>
                      <tr>
                        <td>홍길동</td>
                        <td>25</td>
                      </tr>
                      <tr>
                        <td>이영희</td>
                        <td>28</td>
                      </tr>
                      <tr>
                        <td>김철수</td>
                        <td>30</td>
                      </tr>
                      <tr>
                        <td>박영수</td>
                        <td>22</td>
                      </tr>
                    </table>
                  </div>
                </div>
              </div>
              <p class="diagram-description">
                동일한 구조의 여러 엑셀 파일을 하나의 시트로 합칩니다
              </p>
            </div>
          </div>

          <div class="upload-area" id="uploadArea">
            <div class="upload-icon">📁</div>
            <p class="upload-text">
              엑셀 파일들을 드래그하여 놓거나<br />
              아래 버튼을 클릭하여 선택하세요
            </p>
            <label for="fileInput" class="upload-label">파일 선택하기</label>
            <input type="file" id="fileInput" multiple accept=".xls,.xlsx" />
            <p class="upload-hint">.xls, .xlsx 파일 지원</p>
          </div>

          <div class="file-list" id="fileList"></div>

          <div class="progress" id="progress">
            <div class="progress-text" id="progressText">처리 중...</div>
            <div class="progress-bar">
              <div class="progress-fill" id="progressFill"></div>
            </div>
          </div>

          <div class="stats" id="stats">
            <div class="stat-item">
              <span class="stat-label">총 파일 수:</span>
              <span class="stat-value" id="totalFiles">0</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">총 시트 수:</span>
              <span class="stat-value" id="totalSheets">0</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">총 데이터 행:</span>
              <span class="stat-value" id="totalRows">0</span>
            </div>
          </div>

          <div class="action-buttons">
            <button class="btn btn-secondary" id="clearBtn">초기화</button>
            <button class="btn btn-primary" id="mergeBtn" disabled>
              시트 합치기
            </button>
          </div>

          <div class="preview-container" id="previewContainer">
            <div class="preview-header">
              <h3 class="preview-title">📋 미리보기</h3>
              <span class="preview-info" id="previewInfo"></span>
            </div>
            <div class="table-wrapper">
              <table id="previewTable">
                <thead id="previewHead"></thead>
                <tbody id="previewBody"></tbody>
              </table>
            </div>
          </div>

          <div class="download-section" id="downloadSection">
            <button class="btn btn-success" id="downloadBtn">
              💾 통합 파일 다운로드
            </button>
          </div>
        </div>

        <!-- 시트 생성 도구 -->
        <div id="split-tool" class="tool-container">
          <h2 class="tool-title">시트 생성기</h2>

          <!-- 도식 설명 -->
          <div class="tool-diagram">
            <div class="diagram-title">💡 시트 생성기란?</div>
            <div class="diagram-content">
              <div class="diagram-step">
                <div class="text-example">
                  <div class="text-icon">📝</div>
                  <div class="text-name">텍스트 입력</div>
                  <div class="text-content">
                    <div class="text-line">1월</div>
                    <div class="text-line">2월</div>
                    <div class="text-line">3월</div>
                    <div class="text-line">4월</div>
                    <div class="text-line">5월</div>
                    <div class="text-line">6월</div>
                  </div>
                </div>
                <div class="arrow-icon">→</div>
                <div class="file-example result">
                  <div class="file-icon">📄</div>
                  <div class="file-name">생성된파일.xlsx</div>
                  <div class="sheet-list">
                    <div class="sheet-item result">📋 1월</div>
                    <div class="sheet-item result">📋 2월</div>
                    <div class="sheet-item result">📋 3월</div>
                    <div class="sheet-item result">📋 4월</div>
                    <div class="sheet-item result">📋 5월</div>
                    <div class="sheet-item result">📋 6월</div>
                  </div>
                </div>
              </div>
              <p class="diagram-description">
                입력한 텍스트를 각각의 이름으로 하는 시트들을 생성합니다
              </p>
            </div>
          </div>

          <div class="sheet-creator-container">
            <div class="input-section">
              <h3>시트 이름 입력</h3>
              <p class="input-hint">각 줄에 하나씩 시트 이름을 입력하세요</p>
              <textarea
                id="sheetNamesInput"
                class="sheet-names-input"
                placeholder="1월&#10;2월&#10;3월&#10;4월&#10;5월&#10;6월"
                rows="10"
              ></textarea>

              <div class="input-controls">
                <button class="btn btn-secondary" id="clearSheetNamesBtn">
                  초기화
                </button>
                <button class="btn btn-primary" id="createSheetsBtn">
                  시트 생성
                </button>
              </div>
            </div>

            <div class="preview-section" id="sheetPreviewSection">
              <h3>미리보기</h3>
              <div class="sheet-list" id="sheetList"></div>
              <p class="sheet-count" id="sheetCount"></p>
            </div>

            <div class="download-section" id="sheetDownloadSection">
              <button class="btn btn-success" id="downloadSheetsBtn">
                💾 엑셀 파일 다운로드
              </button>
            </div>
          </div>
        </div>

        <!-- 표 정리 도구 -->
        <div id="convert-tool" class="tool-container">
          <h2 class="tool-title">데이터 표 정리</h2>

          <!-- 도식 설명 -->
          <div class="tool-diagram">
            <div class="diagram-title">💡 데이터 표 정리란?</div>
            <div class="diagram-content">
              <div class="diagram-step">
                <div class="text-example">
                  <div class="text-icon">📝</div>
                  <div class="text-name">세로 나열 데이터</div>
                  <div class="text-content vertical">
                    <div class="text-line">1</div>
                    <div class="text-line">가</div>
                    <div class="text-line">가가</div>
                    <div class="text-line">2</div>
                    <div class="text-line">나</div>
                    <div class="text-line">나나</div>
                    <div class="text-line">3</div>
                    <div class="text-line">다</div>
                    <div class="text-line">다다</div>
                  </div>
                </div>
                <div class="plus-icon">+</div>
                <div class="header-example">
                  <div class="text-icon">🏷️</div>
                  <div class="text-name">열 이름 설정</div>
                  <div class="header-content">
                    <div class="header-item">번호</div>
                    <div class="header-item">이름</div>
                    <div class="header-item">별명</div>
                  </div>
                </div>
                <div class="arrow-icon">→</div>
                <div class="file-example result">
                  <div class="file-icon">📊</div>
                  <div class="file-name">정리된 표</div>
                  <div class="file-table">
                    <table>
                      <tr>
                        <th>번호</th>
                        <th>이름</th>
                        <th>별명</th>
                      </tr>
                      <tr>
                        <td>1</td>
                        <td>가</td>
                        <td>가가</td>
                      </tr>
                      <tr>
                        <td>2</td>
                        <td>나</td>
                        <td>나나</td>
                      </tr>
                      <tr>
                        <td>3</td>
                        <td>다</td>
                        <td>다다</td>
                      </tr>
                    </table>
                  </div>
                </div>
              </div>
              <p class="diagram-description">
                세로로 나열된 데이터를 설정한 열로 정리하여 표 형태로 만듭니다
              </p>
            </div>
          </div>

          <div class="table-organizer-container">
            <!-- 1단계: 데이터 입력 -->
            <div class="step-section active" id="dataInputStep">
              <div class="step-header">
                <h3>1단계: 데이터 입력</h3>
                <p class="step-hint">세로로 나열된 데이터를 입력하세요</p>
              </div>

              <div class="input-area">
                <textarea
                  id="rawDataInput"
                  class="raw-data-input"
                  placeholder="1&#10;가&#10;가가&#10;2&#10;나&#10;나나&#10;3&#10;다&#10;다다&#10;4&#10;라&#10;라라"
                  rows="15"
                ></textarea>

                <div class="input-controls">
                  <button class="btn btn-secondary" id="clearDataBtn">
                    초기화
                  </button>
                  <button class="btn btn-primary" id="nextStepBtn" disabled>
                    다음 단계
                  </button>
                </div>
              </div>
            </div>

            <!-- 2단계: 열 설정 -->
            <div class="step-section" id="columnSetupStep">
              <div class="step-header">
                <h3>2단계: 열 이름 설정</h3>
                <p class="step-hint">각 열의 이름을 입력하세요</p>
              </div>

              <div class="column-setup">
                <div class="column-count-control">
                  <label>열 개수: </label>
                  <input
                    type="number"
                    id="columnCountInput"
                    min="1"
                    max="10"
                    value="3"
                  />
                  <button
                    class="btn btn-secondary btn-small"
                    id="updateColumnsBtn"
                  >
                    적용
                  </button>
                </div>

                <div class="column-headers" id="columnHeaders">
                  <!-- 동적으로 생성됨 -->
                </div>

                <div class="step-controls">
                  <button class="btn btn-secondary" id="prevStepBtn">
                    이전
                  </button>
                  <button class="btn btn-primary" id="generateTableBtn">
                    표 생성
                  </button>
                </div>
              </div>
            </div>

            <!-- 3단계: 결과 표시 -->
            <div class="step-section" id="resultStep">
              <div class="step-header">
                <h3>3단계: 결과</h3>
                <p class="step-hint">정리된 표를 확인하고 복사하세요</p>
              </div>

              <div class="result-container">
                <div class="result-controls">
                  <button class="btn btn-success" id="copyTableBtn">
                    📋 표 복사
                  </button>
                  <button class="btn btn-success" id="downloadTableBtn">
                    💾 엑셀 다운로드
                  </button>
                  <button class="btn btn-secondary" id="restartBtn">
                    다시 시작
                  </button>
                </div>

                <div class="table-result" id="tableResult">
                  <!-- 생성된 표가 여기에 표시됨 -->
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 시트 선택 병합 도구 -->
        <div id="analyze-tool" class="tool-container">
          <h2 class="tool-title">시트 병합</h2>

          <!-- 도식 설명 -->
          <div class="tool-diagram">
            <div class="diagram-title">💡 시트 병합이란?</div>
            <div class="diagram-content">
              <div class="diagram-step">
                <div class="file-example">
                  <div class="file-icon">📄</div>
                  <div class="file-name">파일1.xlsx</div>
                  <div class="sheet-list">
                    <div class="sheet-item selected">📋 시트1 ✓</div>
                    <div class="sheet-item">📋 시트2 ✗</div>
                    <div class="sheet-item selected">📋 시트3 ✓</div>
                  </div>
                </div>
                <div class="plus-icon">+</div>
                <div class="file-example">
                  <div class="file-icon">📄</div>
                  <div class="file-name">파일2.xlsx</div>
                  <div class="sheet-list">
                    <div class="sheet-item selected">📋 시트A ✓</div>
                    <div class="sheet-item">📋 시트B ✗</div>
                    <div class="sheet-item selected">📋 시트C ✓</div>
                  </div>
                </div>
                <div class="arrow-icon">→</div>
                <div class="file-example result">
                  <div class="file-icon">📄</div>
                  <div class="file-name">통합파일.xlsx</div>
                  <div class="sheet-list">
                    <div class="sheet-item result">📋 시트1</div>
                    <div class="sheet-item result">📋 시트3</div>
                    <div class="sheet-item result">📋 시트A</div>
                    <div class="sheet-item result">📋 시트C</div>
                  </div>
                </div>
              </div>
              <p class="diagram-description">
                여러 파일에서 원하는 시트들을 선택해서 하나의 파일로 모읍니다
              </p>
            </div>
          </div>

          <div class="sheet-selector-container">
            <!-- 1단계: 파일 업로드 -->
            <div class="step-section active" id="fileUploadStep">
              <div class="step-header">
                <h3>1단계: 엑셀 파일 업로드</h3>
                <p class="step-hint">병합할 엑셀 파일들을 업로드하세요</p>
              </div>

              <div class="upload-area" id="sheetSelectorUploadArea">
                <div class="upload-icon">📁</div>
                <p class="upload-text">
                  엑셀 파일들을 드래그하여 놓거나<br />
                  아래 버튼을 클릭하여 선택하세요
                </p>
                <label for="sheetSelectorFileInput" class="upload-label"
                  >파일 선택하기</label
                >
                <input
                  type="file"
                  id="sheetSelectorFileInput"
                  multiple
                  accept=".xls,.xlsx"
                />
                <p class="upload-hint">.xls, .xlsx 파일 지원</p>
              </div>

              <div class="uploaded-files" id="uploadedFilesList"></div>

              <div class="step-controls">
                <button class="btn btn-secondary" id="clearFilesBtn">
                  초기화
                </button>
                <button class="btn btn-primary" id="analyzeFilesBtn" disabled>
                  시트 분석
                </button>
              </div>
            </div>

            <!-- 2단계: 시트 선택 -->
            <div class="step-section" id="sheetSelectionStep">
              <div class="step-header">
                <h3>2단계: 시트 선택</h3>
                <p class="step-hint">병합할 시트들을 선택하세요</p>
              </div>

              <div class="selection-controls">
                <button
                  class="btn btn-secondary btn-small"
                  id="selectAllSheetsBtn"
                >
                  전체 선택
                </button>
                <button
                  class="btn btn-secondary btn-small"
                  id="deselectAllSheetsBtn"
                >
                  전체 해제
                </button>
              </div>

              <div class="sheets-list" id="sheetsList">
                <!-- 동적으로 생성됨 -->
              </div>

              <div class="step-controls">
                <button class="btn btn-secondary" id="backToUploadBtn">
                  이전
                </button>
                <button
                  class="btn btn-primary"
                  id="previewSelectedBtn"
                  disabled
                >
                  미리보기
                </button>
              </div>
            </div>

            <!-- 3단계: 미리보기 -->
            <div class="step-section" id="previewStep">
              <div class="step-header">
                <h3>3단계: 선택된 시트 미리보기</h3>
                <p class="step-hint">병합될 시트들을 확인하세요</p>
              </div>

              <div class="preview-summary" id="previewSummary">
                <!-- 선택된 시트 요약 -->
              </div>

              <div class="preview-tabs" id="previewTabs">
                <!-- 미리보기 탭들 -->
              </div>

              <div class="preview-content" id="previewContent">
                <!-- 미리보기 내용 -->
              </div>

              <div class="step-controls">
                <button class="btn btn-secondary" id="backToSelectionBtn">
                  이전
                </button>
                <button class="btn btn-success" id="mergeSelectedSheetsBtn">
                  시트 병합
                </button>
              </div>
            </div>

            <!-- 4단계: 결과 -->
            <div class="step-section" id="resultStep">
              <div class="step-header">
                <h3>4단계: 병합 완료</h3>
                <p class="step-hint">병합된 엑셀 파일을 다운로드하세요</p>
              </div>

              <div class="merge-result" id="mergeResult">
                <!-- 병합 결과 정보 -->
              </div>

              <div class="result-controls">
                <button class="btn btn-success" id="downloadMergedBtn">
                  💾 병합 파일 다운로드
                </button>
                <button class="btn btn-secondary" id="startOverBtn">
                  새로 시작
                </button>
              </div>
            </div>
          </div>
        </div>
      </main>

      <!-- 푸터 -->
      <footer class="app-footer">
        <p>&copy; 2024 Excel Wizard. All rights reserved.</p>
      </footer>
    </div>

    <!-- JavaScript 모듈들 -->
    <script src="js/app.js"></script>
    <script src="js/tools/merge-tool.js"></script>
    <script src="js/tools/sheet-creator.js"></script>
    <script src="js/tools/table-organizer.js"></script>
    <script src="js/tools/sheet-selector.js"></script>
    
    <!-- Language Switcher Script -->
    <script>
      function switchLanguage(lang) {
        // 언어 선택을 쿠키에 저장
        document.cookie = `preferred-language=${lang}; path=/; max-age=31536000`; // 1년
        
        // 해당 언어 페이지로 이동
        if (lang === 'en') {
          window.location.href = '../en/';
        } else {
          window.location.href = '../ko/';
        }
      }
      
      // 페이지 로드시 언어 설정 확인
      document.addEventListener('DOMContentLoaded', function() {
        const savedLang = getCookie('preferred-language');
        if (savedLang) {
          // 언어 버튼 상태 업데이트
          document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.classList.toggle('active', btn.dataset.lang === savedLang);
          });
        }
      });
      
      function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
      }
    </script>
  </body>
</html>
